
<style>
    .page__section form {
        margin-bottom: 20px;
    }

    .page__section form h1 {
        margin-bottom: 10px;
        font-size: 20px;
    }

    .page__section form input[type="text"],
    .page__section form input[type="password"] {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;
    }

    .page__section form input[type="submit"] {
        width: 100%;
        padding: 10px;
        border: none;
        border-radius: 5px;
        background-color: #007bff;
        color: #fff;
        cursor: pointer;
    }

    .page__section form input[type="submit"]:hover {
        background-color: #0056b3;
    }

    code {
        text-align: left;
        display: block;
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #ddd;
        border-radius: 5px;
        background-color: #f9f9f9;
    }

    .language-sql {
        text-align: center;
    }

    form {
        margin-top: 30px;
    }

    h1 {
        margin-top: 30px;
    }

    .user-info {
        margin-top: 20px;
        width: 90%;
        padding: 20px;
        border: none;
        border-radius: 10px;
        background-color: #483D8B;
        color: #fff;
        text-align: center;
        box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.2);
        font-size: 1.2em;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
</style>

<main class="page__main">
    <article class="page__article">
        <header class="page__article-header">
            <h1 class="page__article-header-text">
                Command Injection
            </h1>
        </header>

        <section class="page__section page__section--center">
            <h1>Niezabezpieczony formularz</h1>
            <p>
                Wstrzykiwanie poleceń to technika, która pozwala atakującemu na wykonywanie dowolnych poleceń w systemie operacyjnym za pośrednictwem podatnej aplikacji. W niezabezpieczonej wersji, dane użytkownika są bezpośrednio wstawiane do polecenia systemowego. Na przykład, w metodzie wykonującej polecenie ping:
                <pre><code class="language-php">
                    if (isset($_GET['ip'])) {
                        $ip = $_GET['ip'];
                        $output = shell_exec("ping -n 4 " . $ip);
                        echo nl2br($output);
                    }
                </code></pre>
                Polecenie systemowe jest tworzone przez konkatenację ciągu znaków z danymi użytkownika. Jeśli atakujący wprowadzi wartości, które zmieniają strukturę polecenia systemowego, może to prowadzić do niezamierzonych konsekwencji.
            </p>
            <form method="GET" action="">
                <label for="ip-input">Wprowadź IP do pingu:</label>
                <input type="text" id="ip-input" name="ip">
                <button type="submit">Ping! (Niebezpieczne)</button>
            </form>
            <br>

            <h1>Zabezpieczony formularz</h1>
            <p>
                W zabezpieczonej wersji, dane użytkownika są escapowane, co oznacza, że są traktowane wyłącznie jako dane, a nie część polecenia systemowego. Na przykład, w zabezpieczonej metodzie, która wykonuje polecenie ping:
                <pre><code class="language-php">
                    if (isset($_GET['ip'])) {
                        $ip = escapeshellarg($_GET['ip']);
                        system("ping -n 4 " . $ip);
                    }
                </code></pre>
                Polecenie systemowe jest przygotowane z miejscem na parametr, które jest później wypełniane danymi użytkownika. Zapobiega to manipulacji struktury polecenia systemowego przez atakującego.
            </p>
            <form method="GET" action="">
                <label for="ip-input">Wprowadź IP do pingu:</label>
                <input type="text" id="ip-input" name="ip">
                <button type="submit">Ping! (Bezpieczne)</button>
            </form>
            <br>

            <?php PathService::prevNextButton('/sql-injection', '/file-uploader'); ?>
        </section>
    </article>
</main>